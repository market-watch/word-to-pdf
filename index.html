<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Taurus Office Suite</title>

  <!-- Google Ads and Analytics -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7497119140124063" crossorigin="anonymous"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HW5BLF7ZDS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HW5BLF7ZDS');
  </script>

  <!-- Bulma CSS for minimal theme -->
  <link href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
    }
    .container {
      max-width: 1000px;
      width: 100%;
    }
    .icon-image {
      width: 40px;
      height: 40px;
      margin-bottom: 10px;
    }
    #downloadLink, #mergeDownloadLink, #pdfMergeDownloadLink {
      display: none;
      margin-top: 20px;
    }
    .loader {
      display: none;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1 class="title has-text-centered">Taurus Office Suite</h1>
    
    <div class="columns is-multiline">
      
      <!-- DOCX to PDF Conversion Section -->
      <div class="column is-one-third">
        <form id="uploadForm" enctype="multipart/form-data" class="box">
          <figure class="image is-64x64 has-text-centered">
            <img src="word_icon.png" alt="Word Icon" class="icon-image">
          </figure>
          <h2 class="title is-5 has-text-centered">Convert Word to PDF</h2>
          <div class="field">
            <label class="label">Upload Word File (.doc, .docx)</label>
            <div class="control">
              <input class="input" type="file" name="file" accept=".doc,.docx" required />
            </div>
          </div>
          <div class="control">
            <button class="button is-link is-fullwidth" type="submit" onclick="trackDownloadEvent('Convert Word to PDF')">Convert to PDF</button>
          </div>
          <div id="loader" class="loader has-text-centered">
            <div class="spinner"></div>
            <p>Converting...</p>
          </div>
          <div id="downloadLink">
            <p>Conversion successful! Click the link below to download your PDF.</p>
            <a id="pdfLink" class="button is-primary" href="#" download="converted.pdf">Download PDF</a>
          </div>
          <div id="errorMessage" style="display: none; color: red;">
            <p>There was an error with the conversion. Please try again.</p>
          </div>
        </form>
      </div>

      <!-- Excel Files Merging Section -->
      <div class="column is-one-third">
        <form id="mergeForm" enctype="multipart/form-data" class="box">
          <figure class="image is-64x64 has-text-centered">
            <img src="excel_icon.png" alt="Excel Icon" class="icon-image">
          </figure>
          <h2 class="title is-5 has-text-centered">Merge Excel Files</h2>
          <div class="field">
            <label class="label">Upload Excel Files (.xls, .xlsx)</label>
            <div class="control">
              <input class="input" type="file" name="files" accept=".xls,.xlsx" multiple required />
            </div>
          </div>
          <div class="control">
            <button class="button is-link is-fullwidth" type="submit" onclick="trackDownloadEvent('Merge Excel Files')">Merge Files</button>
          </div>
          <div id="mergeLoader" class="loader has-text-centered">
            <div class="spinner"></div>
            <p>Merging...</p>
          </div>
          <div id="mergeDownloadLink">
            <p>Merge successful! Click the link below to download your merged file.</p>
            <a id="mergedFileLink" class="button is-primary" href="#" download="merged.xlsx">Download Merged File</a>
          </div>
          <div id="mergeErrorMessage" style="display: none; color: red;">
            <p>There was an error with the merging. Please try again.</p>
          </div>
        </form>
      </div>

      <!-- PDF Merging Section -->
      <div class="column is-one-third">
        <form id="pdfMergeForm" enctype="multipart/form-data" class="box">
          <figure class="image is-64x64 has-text-centered">
            <img src="pdf_icon.png" alt="PDF Icon" class="icon-image">
          </figure>
          <h2 class="title is-5 has-text-centered">Merge PDF Files</h2>
          <div class="field">
            <label class="label">Upload PDF Files (.pdf)</label>
            <div class="control">
              <input class="input" type="file" name="pdf_files" accept="application/pdf" multiple required />
            </div>
          </div>
          <div class="control">
            <button class="button is-link is-fullwidth" type="submit" onclick="trackDownloadEvent('Merge PDF Files')">Merge PDFs</button>
          </div>
          <div id="pdfMergeLoader" class="loader has-text-centered">
            <div class="spinner"></div>
            <p>Merging...</p>
          </div>
          <div id="pdfMergeDownloadLink">
            <p>Merge successful! Click the link below to download your merged PDF.</p>
            <a id="pdfMergedFileLink" class="button is-primary" href="#" download="merged_output.pdf">Download Merged PDF</a>
          </div>
          <div id="pdfMergeErrorMessage" style="display: none; color: red;">
            <p>There was an error with the merging. Please try again.</p>
          </div>
        </form>
      </div>

    </div>
  </div>

  <!-- Event Tracking Script -->
  <script>
    function trackDownloadEvent(label) {
      gtag('event', 'click', {
        'event_category': 'download',
        'event_label': label,
        'value': 1
      });
    }
  </script>

  <!-- JavaScript for handling form submissions (similar to previous approach) -->
  <script>
    document.getElementById("uploadForm").addEventListener("submit", async (event) => {
      event.preventDefault();
      handleFormSubmit("uploadForm", "loader", "downloadLink", "pdfLink", "errorMessage", "/convert");
    });

    document.getElementById("mergeForm").addEventListener("submit", async (event) => {
      event.preventDefault();
      handleFormSubmit("mergeForm", "mergeLoader", "mergeDownloadLink", "mergedFileLink", "mergeErrorMessage", "/merge-excel");
    });

    document.getElementById("pdfMergeForm").addEventListener("submit", async (event) => {
      event.preventDefault();
      handleFormSubmit("pdfMergeForm", "pdfMergeLoader", "pdfMergeDownloadLink", "pdfMergedFileLink", "pdfMergeErrorMessage", "https://merge-pdf-510003553016.us-central1.run.app/merge");
    });

    async function handleFormSubmit(formId, loaderId, downloadLinkId, fileLinkId, errorId, url) {
      const form = document.getElementById(formId);
      const loader = document.getElementById(loaderId);
      const downloadLink = document.getElementById(downloadLinkId);
      const fileLink = document.getElementById(fileLinkId);
      const errorMessage = document.getElementById(errorId);
      const formData = new FormData(form);

      loader.style.display = "block";
      downloadLink.style.display = "none";
      errorMessage.style.display = "none";

      try {
        const response = await fetch(url, { method: "POST", body: formData });
        if (response.ok) {
          const blob = await response.blob();
          fileLink.href = URL.createObjectURL(blob);
          loader.style.display = "none";
          downloadLink.style.display = "block";
        } else {
          throw new Error("Conversion failed");
        }
      } catch (error) {
        console.error("Error:", error);
        loader.style.display = "none";
        errorMessage.style.display = "block";
      }
    }
  </script>
</body>
</html>
